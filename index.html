<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<link href="css/style.css" rel="stylesheet" type="text/css" />
<link href="css/jquery-ui.css" rel="stylesheet" type="text/css" />
<script type ="text/javascript" src="js/d3.v3.min.js"></script>
<script type ="text/javascript" src="js/jquery-2.1.1.min.js"></script>
<script type ="text/javascript" src="js/jquery-ui.min.js"></script>
<script type ="text/javascript" src="js/parser.js"></script>
<script type ="text/javascript" src="js/authorbubble.js"></script>
<script type="text/javascript">


    $(document).ready(function(ev){
        $('#error').hide();
        var width = 600;
        var height = 800;
        var canvasId="canvas";
        var canvas = d3.select("#canvas");
        var svgContainer = canvas.append("svg")
                .attr("width", 600)
                .attr("height", 600);
                //.attr('viewBox', "0 0 "+parseInt(width, 10)+" "+parseInt(height, 10));
                // viewbox ist awesome f√ºr navigation in unserem graphen, eingebauter zoom + bildausschnitt
        var year = new Date().getFullYear();
        $("button").button();
        $('#nav').tabs();
        $( "#yearSlider" ).slider({
            range: true,
            min: year-20,
            max: year,
            values: [ year-5, year ],
            slide: function( event, ui ) {
                $( "#amount" ).val( ui.values[ 0 ] + " to " + ui.values[ 1 ] );
                parser.addFilter({
                    year:{
                        from:ui.values[ 0 ],
                        to:ui.values[ 1 ]
                    }
                });
            }
        });
        $( "#amount" ).val(  $( "#yearSlider" ).slider( "values", 0 ) +
        " to " + $( "#yearSlider" ).slider( "values", 1 ) );

        var parser = new Parser({svg:svgContainer});

        $("#searchAuthor").click(function(ev){
            ev.preventDefault();
            options = {};
            options["name"] = $('#name').val();
            //options["year"] = $('#year').val();
            //options["conference"] = $('#conference').val();
            options["paper"] = $('#paper').val();

            parser.callApi(options);

        });

        // SEARCH FORM ANIMATING INPUTS:
        var aniDuration = 200;
        var inputHeightExpanded = '50px';
        var inputHeightCollapsed = '22px';

        $('.input label').click(function(ev){
            // show input
            ev.preventDefault();
            //jquery animate cause of callback.
            $(this).parent().addClass("showInput");
            $(this).parent().animate({'height':inputHeightExpanded,duration:aniDuration/2});
            $(this).animate({'font-size':'9px'},aniDuration,function() {$(this).siblings('input').focus()});
            //css animation method
            // var input = $(this).parent().addClass("showInput");
            //$(this).addClass("small");
            //$(this).parent().find('input').focus();


        });
        $('.input input').focus(function(ev){
            // show input
            //jquery animate cause of callback.
            if(!$(this).parent().hasClass('showInput')){
                $(this).parent().addClass("showInput");
                $(this).parent().animate({'height':inputHeightExpanded,duration:aniDuration/2});
                $(this).siblings('label').animate({'font-size':'9px'},200);

            }
            //css animation method
            // var input = $(this).parent().addClass("showInput");
            //$(this).addClass("small");
            //$(this).parent().find('input').focus();


        });
        $('.input input').blur(function(ev){
            // show input
            if($(this).val() == ""){
                $(this).parent().removeClass("showInput");
                $(this).parent().animate({'height':inputHeightCollapsed,duration:aniDuration});
                $(this).siblings('label').animate({'font-size':'11px'},aniDuration);
            }
            //jquery animate cause of callback.
            //css animation method
            // var input = $(this).parent().addClass("hideInput");


        });



    })
</script>
<body>
<div id="wrap">
    <div id="nav">
        <ul>
            <li><a href="#tabs-1">Search by Author</a></li>
            <li><a href="#tabs-2">Search by Publication</a></li>
        </ul>
        <div id="tabs-1">
            <form action="#">
               <span class="input col4">
                   <label for="name">Author Name:</label> <input value="Wiethoff" type="text" name="name" id="name"/><br/>
                </span>
                <div class="clear"></div>
                <div id="yearSlider"></div>
                <p>
                    <label for="amount">from years </label>
                    <input type="text" id="amount" readonly class="green" style="border:none">
                </p>

                <div class="clear"></div>
                <button name="search" id="searchAuthor"> search</button>
            </form>
        </div>
        <div id="tabs-2">
            <form action="#">
                <span class="input col4">
                   <label for="paper">Publication Title:</label><input type="text" name="paper" id="paper"/><br/>
                </span>
                <div class="clear"></div>
                <button name="search" id="searchButton"> search</button>

            </form>
        </div>
    </div>


    <div id ="canvas">
        <!-- here goes the svg content-->
        <div id="error" class="error"></div>
    </div>
</div>


</body>
</html>